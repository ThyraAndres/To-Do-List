{"ast":null,"code":"import _asyncToGenerator from \"C:/Work/ToDoList/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./storage.service\";\nlet TaskService = /*#__PURE__*/(() => {\n  class TaskService {\n    constructor(storage) {\n      this.storage = storage;\n      this.tasksSubject = new BehaviorSubject([]);\n      this.categoriesSubject = new BehaviorSubject([]);\n      this.tasks$ = this.tasksSubject.asObservable();\n      this.categories$ = this.categoriesSubject.asObservable();\n      this.loadTasks();\n      this.loadCategories();\n    }\n    loadTasks() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const tasks = (yield _this.storage.get('tasks')) || [];\n        _this.tasksSubject.next(tasks);\n      })();\n    }\n    loadCategories() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const categories = (yield _this2.storage.get('categories')) || [];\n        _this2.categoriesSubject.next(categories);\n      })();\n    }\n    addTask(task) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        const newTask = {\n          ...task,\n          id: Date.now().toString(),\n          createdAt: new Date(),\n          updatedAt: new Date()\n        };\n        const tasks = [..._this3.tasksSubject.value, newTask];\n        yield _this3.storage.set('tasks', tasks);\n        _this3.tasksSubject.next(tasks);\n      })();\n    }\n    updateTask(taskId, updates) {\n      var _this4 = this;\n      return _asyncToGenerator(function* () {\n        const tasks = _this4.tasksSubject.value.map(task => task.id === taskId ? {\n          ...task,\n          ...updates,\n          updatedAt: new Date()\n        } : task);\n        yield _this4.storage.set('tasks', tasks);\n        _this4.tasksSubject.next(tasks);\n      })();\n    }\n    deleteTask(taskId) {\n      var _this5 = this;\n      return _asyncToGenerator(function* () {\n        const tasks = _this5.tasksSubject.value.filter(task => task.id !== taskId);\n        yield _this5.storage.set('tasks', tasks);\n        _this5.tasksSubject.next(tasks);\n      })();\n    }\n    addCategory(category) {\n      var _this6 = this;\n      return _asyncToGenerator(function* () {\n        const newCategory = {\n          ...category,\n          id: Date.now().toString(),\n          createdAt: new Date()\n        };\n        const categories = [..._this6.categoriesSubject.value, newCategory];\n        yield _this6.storage.set('categories', categories);\n        _this6.categoriesSubject.next(categories);\n      })();\n    }\n    deleteCategory(categoryId) {\n      var _this7 = this;\n      return _asyncToGenerator(function* () {\n        const categories = _this7.categoriesSubject.value.filter(cat => cat.id !== categoryId);\n        yield _this7.storage.set('categories', categories);\n        _this7.categoriesSubject.next(categories);\n        // Remove category from tasks\n        const tasks = _this7.tasksSubject.value.map(task => task.categoryId === categoryId ? {\n          ...task,\n          categoryId: undefined\n        } : task);\n        yield _this7.storage.set('tasks', tasks);\n        _this7.tasksSubject.next(tasks);\n      })();\n    }\n    getTasksByCategory(categoryId) {\n      return new BehaviorSubject(this.tasksSubject.value.filter(task => categoryId ? task.categoryId === categoryId : !task.categoryId)).asObservable();\n    }\n    static {\n      this.ɵfac = function TaskService_Factory(t) {\n        return new (t || TaskService)(i0.ɵɵinject(i1.StorageService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: TaskService,\n        factory: TaskService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return TaskService;\n})();\nexport { TaskService };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}