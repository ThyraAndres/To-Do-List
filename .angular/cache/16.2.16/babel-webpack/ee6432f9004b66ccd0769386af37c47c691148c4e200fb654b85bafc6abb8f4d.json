{"ast":null,"code":"import _asyncToGenerator from \"C:/Work/ToDoList/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Subject, takeUntil } from 'rxjs';\nlet HomePage = class HomePage {\n  constructor(taskService, firebaseService, alertController, modalController, toastController) {\n    this.taskService = taskService;\n    this.firebaseService = firebaseService;\n    this.alertController = alertController;\n    this.modalController = modalController;\n    this.toastController = toastController;\n    this.tasks = [];\n    this.categories = [];\n    this.filteredTasks = [];\n    this.selectedCategoryId = '';\n    this.showCategoriesFeature = true;\n    this.destroy$ = new Subject();\n  }\n  ngOnInit() {\n    this.loadFeatureFlags();\n    this.loadData();\n  }\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n  loadFeatureFlags() {\n    this.showCategoriesFeature = this.firebaseService.getFeatureFlag('show_categories_feature');\n  }\n  loadData() {\n    this.taskService.tasks$.pipe(takeUntil(this.destroy$)).subscribe(tasks => {\n      this.tasks = tasks;\n      this.filterTasks();\n    });\n    this.taskService.categories$.pipe(takeUntil(this.destroy$)).subscribe(categories => {\n      this.categories = categories;\n    });\n  }\n  filterTasks() {\n    if (this.selectedCategoryId && this.selectedCategoryId !== '') {\n      this.filteredTasks = this.tasks.filter(task => task.categoryId === this.selectedCategoryId);\n    } else {\n      this.filteredTasks = this.tasks;\n    }\n  }\n  onCategoryFilter(categoryId) {\n    this.selectedCategoryId = String(categoryId || '');\n    this.filterTasks();\n  }\n  addTask() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const alert = yield _this.alertController.create({\n        header: 'Nueva Tarea',\n        inputs: [{\n          name: 'title',\n          type: 'text',\n          placeholder: 'Título de la tarea'\n        }, {\n          name: 'description',\n          type: 'textarea',\n          placeholder: 'Descripción (opcional)'\n        }],\n        buttons: [{\n          text: 'Cancelar',\n          role: 'cancel'\n        }, {\n          text: 'Agregar',\n          handler: function () {\n            var _ref = _asyncToGenerator(function* (data) {\n              if (data.title.trim()) {\n                yield _this.taskService.addTask({\n                  title: data.title.trim(),\n                  description: data.description?.trim(),\n                  completed: false,\n                  categoryId: _this.selectedCategoryId || undefined\n                });\n                _this.showToast('Tarea agregada exitosamente');\n              }\n            });\n            return function handler(_x) {\n              return _ref.apply(this, arguments);\n            };\n          }()\n        }]\n      });\n      yield alert.present();\n    })();\n  }\n  toggleTask(task) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      yield _this2.taskService.updateTask(task.id, {\n        completed: !task.completed\n      });\n    })();\n  }\n  deleteTask(task) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      const alert = yield _this3.alertController.create({\n        header: 'Confirmar',\n        message: '¿Estás seguro de que quieres eliminar esta tarea?',\n        buttons: [{\n          text: 'Cancelar',\n          role: 'cancel'\n        }, {\n          text: 'Eliminar',\n          handler: function () {\n            var _ref2 = _asyncToGenerator(function* () {\n              yield _this3.taskService.deleteTask(task.id);\n              _this3.showToast('Tarea eliminada');\n            });\n            return function handler() {\n              return _ref2.apply(this, arguments);\n            };\n          }()\n        }]\n      });\n      yield alert.present();\n    })();\n  }\n  addCategory() {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      const alert = yield _this4.alertController.create({\n        header: 'Nueva Categoría',\n        inputs: [{\n          name: 'name',\n          type: 'text',\n          placeholder: 'Nombre de la categoría'\n        }, {\n          name: 'color',\n          type: 'text',\n          placeholder: 'Color (ej: primary, secondary, success)',\n          value: 'primary'\n        }],\n        buttons: [{\n          text: 'Cancelar',\n          role: 'cancel'\n        }, {\n          text: 'Crear',\n          handler: function () {\n            var _ref3 = _asyncToGenerator(function* (data) {\n              if (data.name.trim()) {\n                yield _this4.taskService.addCategory({\n                  name: data.name.trim(),\n                  color: data.color || 'primary'\n                });\n                _this4.showToast('Categoría creada exitosamente');\n              }\n            });\n            return function handler(_x2) {\n              return _ref3.apply(this, arguments);\n            };\n          }()\n        }]\n      });\n      yield alert.present();\n    })();\n  }\n  deleteCategory(category) {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      const alert = yield _this5.alertController.create({\n        header: 'Confirmar',\n        message: '¿Eliminar esta categoría? Las tareas asociadas perderán su categoría.',\n        buttons: [{\n          text: 'Cancelar',\n          role: 'cancel'\n        }, {\n          text: 'Eliminar',\n          handler: function () {\n            var _ref4 = _asyncToGenerator(function* () {\n              yield _this5.taskService.deleteCategory(category.id);\n              _this5.showToast('Categoría eliminada');\n              if (_this5.selectedCategoryId === category.id) {\n                _this5.selectedCategoryId = '';\n                _this5.filterTasks();\n              }\n            });\n            return function handler() {\n              return _ref4.apply(this, arguments);\n            };\n          }()\n        }]\n      });\n      yield alert.present();\n    })();\n  }\n  getCategoryName(categoryId) {\n    if (!categoryId) return '';\n    const category = this.categories.find(c => c.id === categoryId);\n    return category?.name || '';\n  }\n  getCategoryColor(categoryId) {\n    if (!categoryId) return 'medium';\n    const category = this.categories.find(c => c.id === categoryId);\n    return category?.color || 'medium';\n  }\n  trackByTaskId(index, task) {\n    return task.id;\n  }\n  showToast(message) {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      const toast = yield _this6.toastController.create({\n        message,\n        duration: 2000,\n        position: 'bottom'\n      });\n      yield toast.present();\n    })();\n  }\n};\nHomePage = __decorate([Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss']\n})], HomePage);\nexport { HomePage };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}